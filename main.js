(()=>{"use strict";const e={events:{},on:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},off:function(e,t){if(this.events[e])for(let n=0;n<this.events[e].length;n++)if(this.events[e][n]===t){this.events[e].splice(n,1);break}},emit:function(e,...t){this.events[e]&&this.events[e].forEach((function(e){e(...t)}))}},t=function(){const t=document.querySelector(".add-task-form"),o=document.querySelector(".add-task"),d=document.querySelector(".cancel-task"),i=document.querySelector(".modal-bg"),l=document.querySelector(".to-do-items");function s(){[...l.children].forEach((e=>{e.classList.contains("to-do-item")&&l.removeChild(e)})),n.getCurrentToDoList().forEach((t=>{!function(t){const n=document.createElement("div");n.classList="to-do-item",t.isCompleted&&n.classList.add("completed"),l.appendChild(n);const o=document.createElement("div");o.classList="priority-title",n.appendChild(o);const d=document.createElement("div");d.classList="to-do-item-priority to-do-item-complete",d.style.borderColor=t.isCompleted?"#ddd":`${function(e){let t;switch(e.priority.toString()){case"1":t="red";break;case"2":t="orange";break;case"3":t="yellow";break;case"4":t="green"}return t}(t)}`,d.addEventListener("click",(t=>{t.target.parentElement.parentElement.classList.toggle("completed"),e.emit("completeStatusChanged",t.target.nextSibling.innerText),s()})),o.appendChild(d);const i=document.createElement("div");i.classList="to-do-item-title",i.appendChild(document.createTextNode(t.title)),o.appendChild(i);const a=document.createElement("div");a.classList="duedate-deletebtn",n.appendChild(a);const c=document.createElement("div");c.classList="to-do-item-duedate",c.appendChild(document.createTextNode(t.dueDate)),a.appendChild(c);const r=document.createElement("button");r.classList="to-do-item-delete",r.appendChild(document.createTextNode("x")),r.addEventListener("click",(t=>{const n=t.target.parentElement.parentElement.firstElementChild.innerText,o=t.target.previousSibling.innerText;e.emit("taskDeleted",n,o),s()})),a.appendChild(r);const u=document.createElement("div");u.classList="completed-line",n.appendChild(u)}(t)}))}o.addEventListener("click",(()=>{i.style.display="block"})),d.addEventListener("click",(()=>{i.style.display="none",t.reset()})),i.addEventListener("click",(e=>{e.target.classList.contains("modal-bg")&&(i.style.display="none",t.reset())}));const a=document.getElementById("task-title"),c=document.getElementById("task-due-date"),r=document.getElementById("task-project"),u=document.getElementById("task-priority");return t.addEventListener("submit",(n=>{e.emit("taskAdded",a.value,c.value,r.value,u.value),s(),n.preventDefault(),i.style.display="none",t.reset()})),document.body.onload=function(){t.reset()},{render:s}}(),n=function(){const t=[{title:"Do homework",dueDate:"2021-03-17",project:"default",priority:4,isCompleted:!1},{title:"Go to school",dueDate:"2021-03-19",project:"default",priority:2,isCompleted:!1},{title:"Workout",dueDate:"2021-03-18",project:"default",priority:3,isCompleted:!1},{title:"Sleep",dueDate:"2021-03-22",project:"default",priority:1,isCompleted:!1},{title:"Sleep again",dueDate:"2021-04-03",project:"default",priority:4,isCompleted:!1}];return e.on("completeStatusChanged",(e=>{t.forEach((t=>{t.title!==e||(t.isCompleted=!t.isCompleted)}))})),e.on("taskDeleted",((e,n)=>{for(let o=0;o<t.length;o++)t[o].title===e&&t[o].dueDate===n&&t.splice(o,1)})),e.on("taskAdded",((e,n,o,d)=>{t.push(((e,t,n,o)=>({title:e,dueDate:t,project:n=n||"default",priority:o,isCompleted:!1}))(e,n,o,d))})),{getCurrentToDoList:()=>t}}(),o=new Date;let d=o.getFullYear(),i=o.getMonth()+1;i<10&&(i=`0${i}`);let l=o.getDate();l<10&&(l=`0${l}`),document.querySelector("#task-due-date").min=`${d}-${i}-${l}`,t.render()})();