(()=>{"use strict";const e={events:{},on:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},off:function(e,t){if(this.events[e])for(let o=0;o<this.events[e].length;o++)if(this.events[e][o]===t){this.events[e].splice(o,1);break}},emit:function(e,...t){this.events[e]&&this.events[e].forEach((function(e){e(...t)}))}},t=function(){const t=[{title:"Do homework",dueDate:"2021-03-17",project:"School",priority:4,isCompleted:!1},{title:"Go to school",dueDate:"2021-03-19",project:"School",priority:2,isCompleted:!1},{title:"Workout",dueDate:"2021-03-18",project:"Workout",priority:3,isCompleted:!1},{title:"Sleep",dueDate:"2021-03-22",project:"Recreational",priority:1,isCompleted:!1},{title:"Sleep again",dueDate:"2021-04-03",project:"Recreational",priority:4,isCompleted:!1}];return e.on("completeStatusChanged",(e=>{t.forEach((t=>{t.title!==e||(t.isCompleted=!t.isCompleted)}))})),e.on("taskDeleted",((e,o)=>{for(let n=0;n<t.length;n++)t[n].title===e&&t[n].dueDate===o&&t.splice(n,1)})),e.on("taskAdded",((e,o,n,r)=>{t.push(((e,t,o,n)=>({title:e,dueDate:t,project:o=o||"Default",priority:n,isCompleted:!1}))(e,o,n,r))})),{getCurrentToDoList:()=>t,sortList:function(){t.sort(((e,t)=>e.priority===t.priority?0:e.priority>t.priority?1:-1))}}}(),o=function(){const t=[{projectName:"Default"},{projectName:"School"},{projectName:"Workout"},{projectName:"Recreational"}];return e.on("projectAdded",(e=>{t.push((e=>({projectName:e}))(e))})),e.on("projectDeleted",(e=>{for(let o=0;o<t.length;o++)if(t[o].projectName===e)return void t.splice(o,1)})),{getCurrentProjectList:()=>t}}(),n=function(){const t=document.querySelector(".projects-list");function n(){[...t.children].forEach((e=>{e.classList.contains("project-div")&&t.removeChild(e)}));const r=o.getCurrentProjectList();r.forEach((o=>{!function(o){const r=document.createElement("div");r.classList="project-div",t.appendChild(r);const c=document.createElement("div");c.classList="project-name-counter",r.appendChild(c);const d=document.createElement("div");d.classList="project-name",d.appendChild(document.createTextNode(o.projectName)),c.appendChild(d);const i=document.createElement("div");if(i.classList="counter project-counter",i.id=`${o.projectName.toLowerCase()}-project-counter`,i.appendChild(document.createTextNode("0")),c.appendChild(i),"default"!==o.projectName.toLowerCase()){const t=document.createElement("button");t.classList="project-delete",t.appendChild(document.createTextNode("x")),t.addEventListener("click",(t=>{e.emit("projectDeleted",t.target.previousElementSibling.firstElementChild.innerText),n()})),r.appendChild(t)}}(o)})),e.emit("projectsRendered",r)}return document.querySelector(".projects-add").addEventListener("click",(()=>{const t=prompt("Enter name of project:");e.emit("projectAdded",t),n()})),{render:n}}(),r=function(){const o=document.querySelector(".add-task-form"),n=document.querySelector(".add-task"),r=document.querySelector(".cancel-task"),c=document.querySelector(".modal-bg"),d=document.querySelector(".to-do-items"),i=document.getElementById("task-title"),s=document.getElementById("task-due-date"),l=document.getElementById("task-project"),a=document.getElementById("task-priority");function p(){[...d.children].forEach((e=>{e.classList.contains("to-do-item")&&d.removeChild(e)})),t.sortList(),t.getCurrentToDoList().forEach((t=>{!function(t){const o=document.createElement("div");o.classList="to-do-item",t.isCompleted&&o.classList.add("completed"),d.appendChild(o);const n=document.createElement("div");n.classList="priority-title",o.appendChild(n);const r=document.createElement("div");r.classList="to-do-item-priority to-do-item-complete",r.style.borderColor=t.isCompleted?"#ddd":`${function(e){let t;switch(e.priority.toString()){case"1":t="red";break;case"2":t="orange";break;case"3":t="yellow";break;case"4":t="green"}return t}(t)}`,r.addEventListener("click",(t=>{t.target.parentElement.parentElement.classList.toggle("completed"),e.emit("completeStatusChanged",t.target.nextSibling.innerText),p()})),n.appendChild(r);const c=document.createElement("div");c.classList="to-do-item-title",c.appendChild(document.createTextNode(t.title)),n.appendChild(c);const i=document.createElement("div");i.classList="duedate-deletebtn",o.appendChild(i);const s=document.createElement("div");s.classList="to-do-item-duedate",s.appendChild(document.createTextNode(t.dueDate)),i.appendChild(s);const l=document.createElement("button");l.classList="to-do-item-delete",l.appendChild(document.createTextNode("x")),l.addEventListener("click",(t=>{const o=t.target.parentElement.parentElement.firstElementChild.innerText,n=t.target.previousSibling.innerText;e.emit("taskDeleted",o,n),p()})),i.appendChild(l);const a=document.createElement("div");a.classList="completed-line",o.appendChild(a)}(t)}))}const u=document.querySelector(".task-project");return e.on("projectsRendered",(e=>{u.innerHTML="",e.forEach((e=>{const t=e.projectName,o=document.createElement("option");o.value=t,o.appendChild(document.createTextNode(t)),u.appendChild(o)}))})),e.on("projectAdded",(e=>{const t=document.createElement("option");t.value=e,t.appendChild(document.createTextNode(e)),u.appendChild(t)})),e.on("projectDeleted",(o=>{[...u].forEach((e=>{e.value.toLowerCase()===o.toLowerCase()&&u.removeChild(e)}));const n=t.getCurrentToDoList();let r=n.length;for(;r--;)n[r].project.toLowerCase()===o.toLowerCase()&&(e.emit("taskDeleted",n[r].title,n[r].dueDate),p())})),n.addEventListener("click",(()=>{c.style.display="block"})),r.addEventListener("click",(()=>{c.style.display="none",o.reset()})),c.addEventListener("click",(e=>{e.target.classList.contains("modal-bg")&&(c.style.display="none",o.reset())})),o.addEventListener("submit",(t=>{e.emit("taskAdded",i.value,s.value,l.value,a.value),p(),t.preventDefault(),c.style.display="none",o.reset()})),document.body.onload=function(){o.reset()},{render:p}}(),c=function(){function o(){const e=document.querySelectorAll(".project-counter"),o=t.getCurrentToDoList().reduce(((e,t)=>{let o=t.project.toLowerCase();return e.hasOwnProperty(o)?e[o]+=1:e[o]=1,e}),{});e.forEach((e=>{const t=e.id.split("-")[0],n=o[t]||0;e.innerText=n}))}return document.querySelector("#home-div-counter"),document.querySelector("#today-div-counter"),document.querySelector("#this-week-div-counter"),e.on("taskAdded",o),e.on("taskDeleted",o),e.on("projectsRendered",o),{incrementProjectsCounter:o}}(),d=new Date;let i=d.getFullYear(),s=d.getMonth()+1;s<10&&(s=`0${s}`);let l=d.getDate();l<10&&(l=`0${l}`),document.querySelector("#task-due-date").min=`${i}-${s}-${l}`,r.render(),n.render(),c.incrementProjectsCounter()})();